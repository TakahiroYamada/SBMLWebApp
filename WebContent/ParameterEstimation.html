<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.3.0/Chart.bundle.min.js"></script>
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
<link href="./tabulator/dist/css/tabulator.min.css" rel="stylesheet">
<link href="./bootstrap-4.0.0-alpha.6-dist/css/bootstrap.min.css" rel = "stylesheet">
<link href="./css/Header.css" rel = "stylesheet">
<link href="./css/ParameterEstimation.css" rel="stylesheet">
<script type="text/javascript" src="./tabulator/dist/js/tabulator.min.js"></script>
<script type="text/javascript" src = "parameterAjax.js"> </script>
<script type="text/javascript" src = "generalFunction.js"> </script>
<script type="text/javascript" src = "chartPlugin.js"> </script>
<script type="text/javascript" src = "./tether-master/dist/js/tether.min.js"></script>
<script type="text/javascript" src="./bootstrap-4.0.0-alpha.6-dist/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.js"></script>
<script src="https://fastcdn.org/FileSaver.js/1.1.20151003/FileSaver.min.js"></script>
<script src="https://cdn.jsdelivr.net/jquery.loadingoverlay/latest/loadingoverlay.min.js"></script>
<title>Parameter Estimation : SBML File and Experiment Data : Read and Analyze</title>
</head>
<body>
	<header id = "page-header" role = "banner">
		<div class = "header-div">
			<nav class = "header-nav" id = "head-navcontent" role = "navigation">
				<a id = "page-header-nrnb" class = "nrnb"> NRNB : National Resource for Network Biology</a>
			</nav>
			<div class = "div-nav" id = "divnavcontent">
				<nav class = "top-nav" id = "navcontent" role = "navigation">
					<a class = "lf" href = "./index.html"> SWA </a>
					<p> - Parameter Estimation </p>
					<span id = "brc"></span>
					<span class = "rf">
						<ul id = "swnav">
							<li class = "first-nav"> 
								<a href = "./index.html" title = "SWA home"> Home</a>
							</li>
							<li class = "download">
								<a title = "download"> Download</a>
							</li>
							<li class = "doc">
								<a title = "document"> Document</a>
							</li>
							<li class = "help">
								<a title = "help"> Help</a>
							</li>
						</ul>
					</span>
				</nav>
			</div>
		</div>
	</header>
	<h3> Settings of Analysis</h3>
	<div id = "setting">
		<p id = "file-upload"> Files to upload :  </p>
		<p id = "model-upload"> Model File(SBML) : </p>
		<input id = "paraFile" type = "file" size = "50" accept = ".xml">
		<div id = "expFile" style="display:none">
			<p id = "exp-upload"> Experiment Data : </p>
			<input id = "expData" type = "file" size = "50" accept = ".txt , .csv">
			<br/>
			Algorithm <select id = "algorithm" size = "1">
			<option value = "lv">Leven-Berg Marquardt</option>
			<option value = "nelder"> NelderMead </option>
			<option value = "particleSwarm"> Particle Swarm Optimization</option>
			<option value = "diffEvol"> Differential Evolution</option>
			</select>
		</div>
		<br/>
		<div id = "lvparam" style = "display:none">
			Iteration Limit : <input id = "lvite" class = "param-param" type = "number" value = "2000"> <br/>
			Tolerance : <input id = "lvtol" class = "param-param" type = "number" value = "1.0e-6" step = "1.0e-9"> <br/>
		</div>
		<div id = "nelparam" style = "display:none">
			Iteration Limit : <input id = "nelite" class = "param-param" type = "number" value = "2000"> <br/>
			Tolerance : <input id = "neltol" class = "param-param" type = "number" value = "1.0e-6" step = "1.0e-9"> <br/>
		</div>
		<div id = "partparam" style = "display:none">
			Iteration Limit : <input id = "partite" class = "param-param" type = "number" value = "2000"> <br/>
			Swarm Size : <input id = "partsize" class = "param-param" type = "number" value = "50"> <br/>
			Std. Deviation : <input id = "partstd" class = "param-param" type = "number" value = "1.0e-6" step = "1.0e-9>"> <br/>
			Random Number Generator : <input id = "partran" class = "param-param"  type = "number"  value = "1"> <br/>
			Seed : <input id = "partseed" class = "param-param" type = "number" value = "0"><br/>
		</div>
		<div id = "difevolparam" style = "display:none">
			Population Size : <input id = "difevolpopu" class = "param-param" type = "number" value = "10"> <br/>
			Random Number Generator : <input id = "difevolran" class = "param-param" type = "number" value = "1"> <br/>
			Seed :  <input id = "difevolseed" class = "param-param" type = "number" value = "0"> <br/>
		</div>
	</div>
	<button type = "button" class = "btn btn-primary"id = "paramButton" name = "paramButton"> Execute </button>
	<progress id = "progress" value = "0" max = "100"> </progress>
	<h3> Result of Analysis</h3>
	<div class = "conteiner-fluid" id = "result-container">
		<div class = "tabResult">
			<ul class = "nav nav-tabs">
				<li class = "nav-item">
					<a href="#graph" class = "nav-link" data-toggle = "tab"> Graphical View </a>
				</li>
				<li class = "nav-item">	
					<a href="#numTable" class = "nav-link" data-toggle = "tab" > Numerical Table</a>
				</li>
				<li class = "nav-item">
					<a href="#" class = "nav-link disabled" id = "download" data-toggle = "tab" onclick = "downloadData();"> Download Data</a>
				</li>
			</ul>
			<div class = "tab-content">
				<div id = "graph" class = "tab-pane active">
					<div class = "row">
						<div class = "col-8" id = "graph-contents" style = "display:none">
							<input type="checkbox" id = "before-fitting" onchange="showBeforeFitting();"> Before Fitting
							<div id="before-graph" style="display:none">
								<canvas id="beforeCanvas" height="50" width="100"></canvas>
							</div>
							<div id = "after-graph" style="display:block">
								<canvas id="afterCanvas" height="50" width="100"></canvas>
							</div>
						</div>
						<div class = "col-4" id = "tabParameter" style = "display:none">
							<ul class = "nav nav-tabs" id = "tab-parameter">
								<li class = "nav-item dropdown">
									<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Kinetic Parameter</a>
									<div class = "dropdown-menu">
										<a href="#localParam" id = "local-item" class = "dropdown-item" data-toggle =  "tab"> Local Parameters</a>
										<a href="#globalParam" id = "global-item" class = "dropdown-item" data-toggle =  "tab"> Global Parameters</a>
									</div>									
								</li>
							</ul>
							<div class = "tab-content">
								<div id = "localParam" class = "tab-pane active">
									<div id = "localParam-slider">
									</div>
								</div>
								<div id = "globalParam" class = "tab-pane">
									<div id = "globalParam-slider">
									</div>
								</div>
							</div>
						</div>
					</div>	
				</div>
				<div id = "numTable" class = "tab-pane">
					<div id = "num-table">
					</div>
				</div>
			</div>
		</div>
	</div>	
	<script type = "text/javascript">
	$("#num-table").tabulator({ fitColumns : true,
		rowFormatter:function(row){
	        var data = row.getData();
	        if(Math.abs( data.Upper - data.Update ) < 1.0e-5){
	        	row.getElement().css({"background-color":"red"});
	        }
	        else if( Math.abs( data.Lower - data.Update) < 1.0e-5){
	        	row.getElement().css({"background-color":"blue"});
	        }
	    }
	});
	</script>	
	<script type = "text/javascript" src ="parameterEvent.js"></script>
</body>
</html>